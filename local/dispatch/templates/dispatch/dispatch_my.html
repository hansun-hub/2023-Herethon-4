<!DOCTYPE html>
{% load static %}
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>

        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <link
        rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">

        <link rel="stylesheet" href="{% static 'css/base2.css' %}" />
        <script>
            // HTML이 로드된 후 실행되는 함수
            window.onload = function() {
                var dispatchTimes = document.getElementsByClassName("dispatch-time");
                for (var i = 0; i < dispatchTimes.length; i++) {
                    var createdAt = dispatchTimes[i].textContent;
                    var parsedTime = moment(createdAt, "YYYY-MM-DDTHH:mm:ssZ").fromNow();
                    dispatchTimes[i].textContent = parsedTime;
                }
            };
        </script>
    </head>
    <body>
        <div class="top">
            <img src="{% static 'logo.svg' %}" />
            <div style="float: right">
                <img src="{% static 'alert.svg' %}" />
                <img src="{% static 'ticket.svg' %}" />
                <b class="logout" style="color: #ff552b">3개</b>
            </div>
        </div>
        <div>
            <ul class="menu1">
                <li>
                    <a href="{% url 'dispatch:all_list' %}"><b>전체</b></a>
                </li>
                <li>
                    <a href="{% url 'dispatch:near_list' %}">여기 근처</a>
                </li>
                <li>
                    <a href="{% url 'dispatch:my_list' %}">내 파견</a>
                </li>
            </ul>
        </div>
        <!---->
        <li class="list-group-item">
<!--            <div style="display:flex; flex-direction:row">-->
            <div style="display:flex;">
            <div
                style="
                    width: 40px;
                    height: 40px;"><img style="
                    width: 40px;
                    height: 40px; border-radius:100%" src="{% static 'profile.svg' %}" style="border-radius:10px">
            </div>
                {% for dispatch_obj in my_dispatchs %}
            <div style="margin-left:5px">
                {{ dispatch_obj.author }}<br>
                {{ dispatch_obj.city }}, {{ dispatch_obj.country }}
                </div>
                </div>
                <a href="{% url 'dispatch:dispatch_detail' pk=dispatch_obj.pk %}">{{ dispatch_obj.content }}</a>
                <br>
                <br>
                <span class="dispatch-time">{{ dispatch_obj.created_at|date:'Y-m-d H:i:s' }}</span>

                <hr>
                {% for comment in dispatch_obj.comment_set.all %}
                <div>
                    <strong>{{ comment.author }}</strong>
                    <p>{{ comment.content }}</p>
                </div>
                {% empty %}
                <p>작성한 댓글이 없습니다.</p>
                {% endfor %}
                {% empty %}
                <p>작성한 dispatch가 없습니다.</p>
                {% endfor %}
            </li>

        <a href="{% url 'dispatch:dispatch_post' %}"><img src="{% static 'plus.svg' %}" id="plus" /></a>
        <footer>
            <div class="footer">
                <ul class="foot">
                    <li>
                        <a href=""><img src="{% static 'Group 4.svg' %}" /></a>
                    </li>
                    <li>
                        <a href=""
                            ><img src="{% static 'Group 3on.svg' %}"
                        /></a>
                    </li>
                    <li><img src="{% static 'Group 2.svg' %}" /></li>
                    <li><img src="{% static 'Group 511.svg' %}" /></li>
                </ul>
            </div>
        </footer>
        <script src="{% static 'js/moreComments.js' %}"></script>
    </body>
</html>
